{"ast":null,"code":"var _jsxFileName = \"/home/ethanh/Desktop/socket-squares-project/v1/src/components/Account.js\",\n    _s = $RefreshSig$();\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCoins } from '@fortawesome/free-solid-svg-icons';\nimport useAuth from '../hooks/useAuth';\nimport { useEffect, useState, useRef } from 'react';\nimport useAxiosPrivate from '../hooks/useAxiosPrivate';\nimport \"./css/Account.css\";\nimport axios from '../api/axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Account = () => {\n  _s();\n\n  var _imageRef$current2;\n\n  const {\n    auth,\n    setAuth\n  } = useAuth();\n  const axiosPrivate = useAxiosPrivate();\n  const [image, setImage] = useState({});\n  const [imageUrl, setImageUrl] = useState();\n  const [isLoading, setIsLoading] = useState(false);\n  const [errMsg, setErrMsg] = useState();\n  const [successMsg, setSuccessMsg] = useState();\n  const imageRef = useRef();\n\n  const upload = async e => {\n    var _imageRef$current;\n\n    setErrMsg('');\n    setSuccessMsg('');\n    const file = imageRef === null || imageRef === void 0 ? void 0 : (_imageRef$current = imageRef.current) === null || _imageRef$current === void 0 ? void 0 : _imageRef$current.files[0];\n    if (!file) return console.log(\"NO\");\n    e.preventDefault();\n    console.log(imageRef.current.files[0]);\n    setIsLoading(true);\n    const response = await axiosPrivate.get('/api/s3/geturl');\n    const url = response.data.url; //add to aws\n\n    try {\n      await axios.put(url, file, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      }); //send back new url to server\n\n      const updateResponse = await axiosPrivate.post(\"/api/s3/updateurl\", {\n        data: {\n          url: url.split('?')[0]\n        }\n      });\n      console.log(updateResponse.data.coins);\n      setAuth(prev => {\n        return { ...prev,\n          coins: updateResponse.data.coins\n        };\n      });\n    } catch (err) {\n      var _err$response;\n\n      setIsLoading(false);\n\n      if (!(err !== null && err !== void 0 && err.response)) {\n        setErrMsg('No server response');\n      } else if (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 0) {\n        setErrMsg(\"Error connecting to server\");\n      } else {\n        setErrMsg(\"Error updating image\");\n      }\n\n      return;\n    }\n\n    setIsLoading(false);\n    setSuccessMsg(\"SUCCESS\");\n  };\n\n  const onImageChange = e => {\n    setImage(e.target.files[0]);\n  };\n\n  useEffect(() => {\n    if (!image.name) return;\n    setImageUrl(URL.createObjectURL(image));\n  }, [image]);\n  return isLoading ? /*#__PURE__*/_jsxDEV(\"h2\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 11\n  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"profile\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"user-data\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: auth.user\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faCoins\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 20\n        }, this), auth.coins]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: upload,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"imageInput\",\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: onImageChange,\n        ref: imageRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: imageUrl\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !(imageRef !== null && imageRef !== void 0 && (_imageRef$current2 = imageRef.current) !== null && _imageRef$current2 !== void 0 && _imageRef$current2.files[0]),\n        children: \"Upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: errMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: successMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Account, \"/r/1ORs+B0FXiZl/QPvOBco+RPE=\", false, function () {\n  return [useAuth, useAxiosPrivate];\n});\n\n_c = Account;\nexport default Account;\n\nvar _c;\n\n$RefreshReg$(_c, \"Account\");","map":{"version":3,"names":["FontAwesomeIcon","faCoins","useAuth","useEffect","useState","useRef","useAxiosPrivate","axios","Account","auth","setAuth","axiosPrivate","image","setImage","imageUrl","setImageUrl","isLoading","setIsLoading","errMsg","setErrMsg","successMsg","setSuccessMsg","imageRef","upload","e","file","current","files","console","log","preventDefault","response","get","url","data","put","headers","updateResponse","post","split","coins","prev","err","status","onImageChange","target","name","URL","createObjectURL","user"],"sources":["/home/ethanh/Desktop/socket-squares-project/v1/src/components/Account.js"],"sourcesContent":["import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCoins } from '@fortawesome/free-solid-svg-icons';\nimport useAuth from '../hooks/useAuth'\nimport { useEffect, useState, useRef } from 'react';\nimport useAxiosPrivate from '../hooks/useAxiosPrivate';\n\nimport \"./css/Account.css\" \nimport axios from '../api/axios';\n\nconst Account = () => {\n    const {auth,setAuth} = useAuth();\n    const axiosPrivate = useAxiosPrivate();\n    const [image, setImage] = useState({});\n    const [imageUrl, setImageUrl] = useState();\n    const [isLoading, setIsLoading] = useState(false);\n    const [errMsg, setErrMsg] = useState();\n    const [successMsg, setSuccessMsg] = useState();\n    const imageRef = useRef();\n\n    const upload = async(e)=>{\n        setErrMsg('');\n        setSuccessMsg('');\n        const file = imageRef?.current?.files[0];\n\n        if(!file) return console.log(\"NO\");\n        \n        e.preventDefault();\n        console.log(imageRef.current.files[0])\n        setIsLoading(true)\n        const response = await axiosPrivate.get('/api/s3/geturl');\n        const url = response.data.url;\n\n        //add to aws\n        try{\n           await axios.put(url,file,{\n                headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                },   \n            })\n\n            //send back new url to server\n            const updateResponse = await axiosPrivate.post(\"/api/s3/updateurl\",\n            {\n                data:{\n                    url: url.split('?')[0]\n                }\n            })\n            console.log(updateResponse.data.coins)\n            setAuth(prev => {return{...prev, coins:updateResponse.data.coins}})\n        } catch (err){\n            setIsLoading(false)\n            if(!err?.response){\n                setErrMsg('No server response');\n            }else if(err.response?.status===0){\n                setErrMsg(\"Error connecting to server\")\n            }else{\n                setErrMsg(\"Error updating image\")\n            }  \n            return;\n        }\n\n\n        \n        setIsLoading(false);\n        setSuccessMsg(\"SUCCESS\");\n    }\n\n    const onImageChange = (e) =>{\n        setImage(e.target.files[0]);\n    }\n\n    useEffect(() =>{\n        if(!image.name) return;\n        setImageUrl(URL.createObjectURL(image));\n    },[image])\n\n    return (        \n        isLoading\n        ? <h2>Loading...</h2>\n        :\n        <div id=\"profile\">\n            <div id=\"user-data\">\n                <h1>{auth.user}</h1>\n                <br />\n                <p><FontAwesomeIcon icon={faCoins}/>{auth.coins}</p>\n            </div>\n            <form onSubmit={upload}>\n                <input id='imageInput' type=\"file\" accept=\"image/*\" onChange={onImageChange} ref={imageRef}/>\n                <img src={imageUrl}/>\n                <button type=\"submit\" disabled={!imageRef?.current?.files[0]}>Upload</button>\n                <h2>{errMsg}</h2>\n                <h2>{successMsg}</h2>\n            </form>\n        </div>\n        \n    )\n}\n\nexport default Account"],"mappings":"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"},"metadata":{},"sourceType":"module"}