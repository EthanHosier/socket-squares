{"ast":null,"code":"var _jsxFileName = \"/home/ethanh/Desktop/socket-squares-project/v1/src/components/Account.js\",\n    _s = $RefreshSig$();\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCoins } from '@fortawesome/free-solid-svg-icons';\nimport useAuth from '../hooks/useAuth';\nimport { useEffect, useState, useRef } from 'react';\nimport useAxiosPrivate from '../hooks/useAxiosPrivate';\nimport \"./css/Account.css\";\nimport axios from '../api/axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Account = () => {\n  _s();\n\n  var _imageRef$current2;\n\n  const {\n    auth\n  } = useAuth();\n  const axiosPrivate = useAxiosPrivate();\n  const [image, setImage] = useState({});\n  const [imageUrl, setImageUrl] = useState();\n  const [isLoading, setIsLoading] = useState(false);\n  const [errMsg, setErrMsg] = useState();\n  const [successMsg, setSuccessMsg] = useState();\n  const imageRef = useRef();\n\n  const upload = async e => {\n    var _imageRef$current;\n\n    setErrMsg('');\n    setSuccessMsg('');\n    const file = imageRef === null || imageRef === void 0 ? void 0 : (_imageRef$current = imageRef.current) === null || _imageRef$current === void 0 ? void 0 : _imageRef$current.files[0];\n    if (!file) return console.log(\"NO\");\n    e.preventDefault();\n    console.log(imageRef.current.files[0]);\n    setIsLoading(true);\n    const response = await axiosPrivate.get('/api/s3/geturl');\n    const url = response.data.url; //add to aws\n\n    try {\n      await axios.put(url, file, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      });\n    } catch (err) {\n      console.error(err);\n      return;\n    } //send back new url to server\n\n\n    const updateResponse = await axiosPrivate.post(\"/api/s3/updateurl\", {\n      data: {\n        url: url.split('?')[0]\n      }\n    });\n    console.log(response);\n    setIsLoading(false);\n  };\n\n  const onImageChange = e => {\n    setImage(e.target.files[0]);\n  };\n\n  useEffect(() => {\n    if (!image.name) return;\n    setImageUrl(URL.createObjectURL(image));\n  }, [image]);\n  return isLoading ? /*#__PURE__*/_jsxDEV(\"h2\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 11\n  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"profile\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"user-data\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: auth.user\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faCoins\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 20\n        }, this), auth.coins]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: upload,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"imageInput\",\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: onImageChange,\n        ref: imageRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: imageUrl\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !(imageRef !== null && imageRef !== void 0 && (_imageRef$current2 = imageRef.current) !== null && _imageRef$current2 !== void 0 && _imageRef$current2.files[0]),\n        children: \"Upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: errMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: successMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Account, \"V04JdhKIdkujZBVNEQgZl/WqpnA=\", false, function () {\n  return [useAuth, useAxiosPrivate];\n});\n\n_c = Account;\nexport default Account;\n\nvar _c;\n\n$RefreshReg$(_c, \"Account\");","map":{"version":3,"names":["FontAwesomeIcon","faCoins","useAuth","useEffect","useState","useRef","useAxiosPrivate","axios","Account","auth","axiosPrivate","image","setImage","imageUrl","setImageUrl","isLoading","setIsLoading","errMsg","setErrMsg","successMsg","setSuccessMsg","imageRef","upload","e","file","current","files","console","log","preventDefault","response","get","url","data","put","headers","err","error","updateResponse","post","split","onImageChange","target","name","URL","createObjectURL","user","coins"],"sources":["/home/ethanh/Desktop/socket-squares-project/v1/src/components/Account.js"],"sourcesContent":["import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCoins } from '@fortawesome/free-solid-svg-icons';\nimport useAuth from '../hooks/useAuth'\nimport { useEffect, useState, useRef } from 'react';\nimport useAxiosPrivate from '../hooks/useAxiosPrivate';\n\nimport \"./css/Account.css\" \nimport axios from '../api/axios';\n\nconst Account = () => {\n    const {auth} = useAuth();\n    const axiosPrivate = useAxiosPrivate();\n    const [image, setImage] = useState({});\n    const [imageUrl, setImageUrl] = useState();\n    const [isLoading, setIsLoading] = useState(false);\n    const [errMsg, setErrMsg] = useState();\n    const [successMsg, setSuccessMsg] = useState();\n    const imageRef = useRef();\n\n    const upload = async(e)=>{\n        setErrMsg('');\n        setSuccessMsg('');\n        const file = imageRef?.current?.files[0];\n\n        if(!file) return console.log(\"NO\");\n        \n        e.preventDefault();\n        console.log(imageRef.current.files[0])\n        setIsLoading(true)\n        const response = await axiosPrivate.get('/api/s3/geturl');\n        const url = response.data.url;\n\n        //add to aws\n        try{\n           await axios.put(url,file,{\n                headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                },   \n            })\n        } catch (err){\n            console.error(err);\n            return;\n        }\n\n        //send back new url to server\n        const updateResponse = await axiosPrivate.post(\"/api/s3/updateurl\",\n            {\n                data:{\n                    url: url.split('?')[0]\n                }\n            }\n        )\n\n        console.log(response);\n        setIsLoading(false);\n        \n    }\n\n    const onImageChange = (e) =>{\n        setImage(e.target.files[0]);\n    }\n\n    useEffect(() =>{\n        if(!image.name) return;\n        setImageUrl(URL.createObjectURL(image));\n    },[image])\n\n    return (        \n        isLoading\n        ? <h2>Loading...</h2>\n        :\n        <div id=\"profile\">\n            <div id=\"user-data\">\n                <h1>{auth.user}</h1>\n                <br />\n                <p><FontAwesomeIcon icon={faCoins}/>{auth.coins}</p>\n            </div>\n            <form onSubmit={upload}>\n                <input id='imageInput' type=\"file\" accept=\"image/*\" onChange={onImageChange} ref={imageRef}/>\n                <img src={imageUrl}/>\n                <button type=\"submit\" disabled={!imageRef?.current?.files[0]}>Upload</button>\n                <h2>{errMsg}</h2>\n                <h2>{successMsg}</h2>\n            </form>\n        </div>\n        \n    )\n}\n\nexport default Account"],"mappings":"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"},"metadata":{},"sourceType":"module"}